{% extends 'admin_all/base.html' %}
{% block define %}
    <script>
       $(document).ready(function(){
           $('#page_title').text('管理地区管理员');
           $('#manage_admin').addClass('active');
       })
    </script>
    <div class="col-md-12 col-lg-12" style="padding-left: 10%;padding-right: 10%;padding-top: 5%">
       <table class="table">
           <thead>
             <tr>
                 <h6 style="padding-bottom: 1%">
                 地区管理员列表
                     <button id="delete" class="btn btn-default" style="float: right;margin-left: 2%;margin-right: 1%">删除</button>
                 </h6>
                 <script>
                       $('#delete').click(function(){
                           var s = 1;
                           if( s == 2 {% for item in items %}|| $('#checkbox{{ item.id }}').val() == '1'{% endfor %}){
                               var r = confirm("确定删除所选择的管理员吗？");
                               if(r == true){
                                   var admins = new Array();
                                   {% for item in items %}
                                       if($('#checkbox{{ item.id }}').val() == '1'){
                                           admins.push({{ item.username }})
                                       }
                                   {% endfor %}
                                   var message = {'admins': admins,
                                                  'csrfmiddlewaretoken': getCookie('csrftoken')};
                                        $.ajax({
                                            type: 'POST',
                                            url: 'delete_admin',
                                            data: message,
                                            success: function (data) {
                                                if (data == 'T') {
                                                    alert("删除成功");
                                                    window.location.href = "manage_admin"
                                                }
                                                else {
                                                    alert("删除失败！")
                                                }
                                            },
                                            dataType: 'json'
                                        });

                               }
                           }
                           else{
                               alert("请选择管理员")
                           }
                       })
                 </script>
             </tr>
           </thead>
           <tbody>
              <tr style="background-color: #1abc9c; color: #ffffff">
                  <th>管理地区</th>
                  <th>姓名</th>
                  <th>电话</th>
                  <th>工号</th>
                  <th style="max-width: 20px">
                        <input type="checkbox" value="0" id="checkbox_all">
                      <script>
                          $('#checkbox_all').click(function(){
                              if($(this).val() == '0'){
                                  $(this).val('1');
                                  {% for item in items %}
                                      $('#checkbox{{ item.id }}').val('1');
                                      document.getElementById('checkbox{{ item.id }}').checked = true;
                                  {% endfor %}
                              }
                              else{
                                  $(this).val('0');
                                  {% for item in items %}
                                      $('#checkbox{{ item.id }}').val('0');
                                      document.getElementById('checkbox{{ item.id }}').checked = false;
                                  {% endfor %}
                              }
                          })
                      </script>
                  </th>
              </tr>
              {% for item in items %}
              <tr>
                  <td>{{ item.area }}</td>
                  <td>{{ item.nick }}</td>
                  <td>{{ item.username }}</td>
                  <td>{{ item.work_num }}</td>
                  <td style="max-width: 20px">
                     <input type="checkbox" value="0" name='checkbox' id="checkbox{{ item.id }}">
                  </td>
                  <script>
                     $('#checkbox{{ item.id }}').click(function(){
                         if($(this).val() == '0'){
                             $(this).val('1');
                         }
                         else{
                             $(this).val('0')
                         }
                     })
                  </script>
              </tr>
              {% endfor %}
           </tbody>
       </table>
    </div>
{% endblock %}